module.exports=[27689,a=>{"use strict";a.s(["default",()=>O],27689);var b=a.i(87924),c=a.i(50944),d=a.i(72131),e=a.i(50832),f=a.i(62067),g=a.i(96438),h=a.i(94988),i=a.i(31419),j=a.i(71987),k=a.i(77528);function l({selectedToken:a,onSelect:c,excludeToken:e,disabled:f=!1,label:g}){let[h,i]=(0,d.useState)(!1),l=(0,d.useRef)(null),m=k.TOKENS[a],n=Object.keys(k.TOKENS).filter(a=>a!==e);return(0,d.useEffect)(()=>{function a(a){l.current&&!l.current.contains(a.target)&&i(!1)}if(h)return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[h]),(0,b.jsxs)("div",{className:"relative",ref:l,children:[g&&(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:g}),(0,b.jsxs)("button",{type:"button",onClick:()=>!f&&i(!h),disabled:f,className:`
          w-full flex items-center gap-3 px-4 py-3 rounded-xl
          border border-white/10 bg-white/5
          transition-all duration-200
          ${f?"opacity-50 cursor-not-allowed":"hover:bg-white/10 hover:border-white/20 active:bg-white/15"}
        `,children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[m.logoUrl&&(0,b.jsx)("div",{className:"w-8 h-8 rounded-full bg-white/10 flex items-center justify-center overflow-hidden",children:(0,b.jsx)(j.default,{src:m.logoUrl,alt:m.symbol,width:32,height:32,className:"w-6 h-6"})}),(0,b.jsxs)("div",{className:"flex flex-col items-start",children:[(0,b.jsx)("span",{className:"text-white font-semibold",children:m.symbol}),(0,b.jsx)("span",{className:"text-xs text-gray-400",children:m.name})]})]}),(0,b.jsx)("svg",{className:`w-5 h-5 text-gray-400 transition-transform duration-200 ${h?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),h&&!f&&(0,b.jsx)("div",{className:"absolute z-50 w-full mt-2 rounded-xl border border-white/10 bg-gray-900/95 backdrop-blur-xl shadow-2xl overflow-hidden animate-fadeIn",children:(0,b.jsx)("div",{className:"py-2",children:n.map(d=>{let e=k.TOKENS[d],f=d===a;return(0,b.jsxs)("button",{type:"button",onClick:()=>{c(d),i(!1)},className:`
                    w-full flex items-center gap-3 px-4 py-3
                    transition-colors duration-200
                    ${f?"bg-blue-500/20 text-white":"hover:bg-white/5 text-gray-300"}
                  `,children:[e.logoUrl&&(0,b.jsx)("div",{className:"w-8 h-8 rounded-full bg-white/10 flex items-center justify-center overflow-hidden",children:(0,b.jsx)(j.default,{src:e.logoUrl,alt:e.symbol,width:32,height:32,className:"w-6 h-6"})}),(0,b.jsxs)("div",{className:"flex flex-col items-start flex-1",children:[(0,b.jsx)("span",{className:"font-semibold",children:e.symbol}),(0,b.jsx)("span",{className:"text-xs text-gray-400",children:e.name})]}),f&&(0,b.jsx)("svg",{className:"w-5 h-5 text-blue-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})]},d)})})})]})}var m=a.i(48313),n=a.i(78354);let o="0xE592427A0AEce92De3Edee1F18E0157C05861564",p=[{inputs:[{components:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"address",name:"tokenOut",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{internalType:"uint24",name:"fee",type:"uint24"},{internalType:"uint160",name:"sqrtPriceLimitX96",type:"uint160"}],internalType:"struct IQuoterV2.QuoteExactInputSingleParams",name:"params",type:"tuple"}],name:"quoteExactInputSingle",outputs:[{internalType:"uint256",name:"amountOut",type:"uint256"},{internalType:"uint160",name:"sqrtPriceX96After",type:"uint160"},{internalType:"uint32",name:"initializedTicksCrossed",type:"uint32"},{internalType:"uint256",name:"gasEstimate",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"address",name:"tokenOut",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"uint24",name:"fee",type:"uint24"},{internalType:"uint160",name:"sqrtPriceLimitX96",type:"uint160"}],internalType:"struct IQuoterV2.QuoteExactOutputSingleParams",name:"params",type:"tuple"}],name:"quoteExactOutputSingle",outputs:[{internalType:"uint256",name:"amountIn",type:"uint256"},{internalType:"uint160",name:"sqrtPriceX96After",type:"uint160"},{internalType:"uint32",name:"initializedTicksCrossed",type:"uint32"},{internalType:"uint256",name:"gasEstimate",type:"uint256"}],stateMutability:"nonpayable",type:"function"}],q=[{inputs:[{components:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"address",name:"tokenOut",type:"address"},{internalType:"uint24",name:"fee",type:"uint24"},{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256",name:"deadline",type:"uint256"},{internalType:"uint256",name:"amountIn",type:"uint256"},{internalType:"uint256",name:"amountOutMinimum",type:"uint256"},{internalType:"uint160",name:"sqrtPriceLimitX96",type:"uint160"}],internalType:"struct ISwapRouter.ExactInputSingleParams",name:"params",type:"tuple"}],name:"exactInputSingle",outputs:[{internalType:"uint256",name:"amountOut",type:"uint256"}],stateMutability:"payable",type:"function"},{inputs:[{components:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"address",name:"tokenOut",type:"address"},{internalType:"uint24",name:"fee",type:"uint24"},{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256",name:"deadline",type:"uint256"},{internalType:"uint256",name:"amountOut",type:"uint256"},{internalType:"uint256",name:"amountInMaximum",type:"uint256"},{internalType:"uint160",name:"sqrtPriceLimitX96",type:"uint160"}],internalType:"struct ISwapRouter.ExactOutputSingleParams",name:"params",type:"tuple"}],name:"exactOutputSingle",outputs:[{internalType:"uint256",name:"amountIn",type:"uint256"}],stateMutability:"payable",type:"function"}];function r({isOpen:a,onClose:c,quote:e,gasEstimate:f,needsApproval:h,onConfirm:j,onApprove:k,isSwapping:l,isApproving:o}){let[p,q]=(0,d.useState)(""),[r,s]=(0,d.useState)(null),t=async()=>{if(!p)return void s("Password is required");s(null);try{h?await k(p):await j(p)}catch(a){console.error("Transaction failed:",a),s(a instanceof Error?a.message:"Transaction failed")}},u=()=>{l||o||(q(""),s(null),c())},v=e.priceImpact>5;return(0,b.jsx)(m.Modal,{isOpen:a,onClose:u,title:h?"Approve Token":"Confirm Swap",children:(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 rounded-xl bg-white/5 border border-white/10",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-400 mb-1",children:"You Pay"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-white",children:e.amountIn})]}),(0,b.jsx)("div",{className:"text-right",children:(0,b.jsx)("p",{className:"text-lg font-semibold text-white",children:e.tokenIn})})]}),(0,b.jsx)("div",{className:"flex justify-center",children:(0,b.jsx)("div",{className:"w-10 h-10 rounded-full bg-blue-500/20 flex items-center justify-center",children:(0,b.jsx)("svg",{className:"w-5 h-5 text-blue-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})})})}),(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 rounded-xl bg-white/5 border border-white/10",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-400 mb-1",children:"You Receive"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-white",children:e.amountOut}),(0,b.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Min: ",e.minAmountOutFormatted]})]}),(0,b.jsx)("div",{className:"text-right",children:(0,b.jsx)("p",{className:"text-lg font-semibold text-white",children:e.tokenOut})})]})]}),(0,b.jsxs)("div",{className:"space-y-3 p-4 rounded-xl bg-white/5 border border-white/10",children:[(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-gray-400",children:"Exchange Rate"}),(0,b.jsxs)("span",{className:"text-white font-medium",children:["1 ",e.tokenIn," = ",e.exchangeRate," ",e.tokenOut]})]}),(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-gray-400",children:"Price Impact"}),(0,b.jsxs)("span",{className:`font-medium ${e.priceImpact>5?"text-yellow-400":"text-green-400"}`,children:[e.priceImpact.toFixed(2),"%"]})]}),(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-gray-400",children:"Slippage Tolerance"}),(0,b.jsxs)("span",{className:"text-white font-medium",children:[e.slippageTolerance,"%"]})]}),(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-gray-400",children:"Pool Fee"}),(0,b.jsxs)("span",{className:"text-white font-medium",children:[(e.poolFee/1e4).toFixed(2),"%"]})]}),f&&(0,b.jsxs)("div",{className:"flex justify-between text-sm pt-3 border-t border-white/10",children:[(0,b.jsx)("span",{className:"text-gray-400",children:"Network Fee"}),(0,b.jsxs)("span",{className:"text-white font-medium",children:["~",parseFloat(f.totalCostEth).toFixed(6)," ETH"]})]})]}),v&&(0,b.jsx)(i.Alert,{variant:"warning",children:(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("svg",{className:"w-5 h-5 text-yellow-400 mt-0.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-semibold text-yellow-400",children:"High Price Impact"}),(0,b.jsxs)("p",{className:"text-sm text-gray-300 mt-1",children:["This swap has a price impact of ",e.priceImpact.toFixed(2),"%. Consider reducing the swap amount."]})]})]})}),h&&(0,b.jsx)(i.Alert,{variant:"info",children:(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("svg",{className:"w-5 h-5 text-blue-400 mt-0.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-semibold text-blue-400",children:"Approval Required"}),(0,b.jsxs)("p",{className:"text-sm text-gray-300 mt-1",children:["You need to approve ",e.tokenIn," spending before you can swap. This is a one-time transaction."]})]})]})}),(0,b.jsx)("div",{children:(0,b.jsx)(n.PasswordInput,{label:"Confirm with Password",value:p,onChange:a=>q(a.target.value),placeholder:"Enter your wallet password",disabled:l||o,autoComplete:"current-password"})}),r&&(0,b.jsx)(i.Alert,{variant:"error",children:r}),(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsx)(g.Button,{variant:"secondary",onClick:u,disabled:l||o,className:"flex-1",children:"Cancel"}),(0,b.jsx)(g.Button,{variant:"primary",onClick:t,disabled:!p||l||o,isLoading:l||o,className:"flex-1",children:h?o?"Approving...":"Approve":l?"Swapping...":"Confirm Swap"})]}),(l||o)&&(0,b.jsxs)("div",{className:"text-center text-sm text-gray-400",children:[(0,b.jsx)("p",{children:"Please wait while the transaction is being processed..."}),(0,b.jsx)("p",{className:"mt-1",children:"Do not close this window."})]})]})})}var s=a.i(93059),t=a.i(94101),u=a.i(90036),v=a.i(66585),w=a.i(47703),x=a.i(68533),y=a.i(99959);let z=[{constant:!0,inputs:[],name:"name",outputs:[{name:"",type:"string"}],type:"function"},{constant:!0,inputs:[],name:"symbol",outputs:[{name:"",type:"string"}],type:"function"},{constant:!0,inputs:[],name:"decimals",outputs:[{name:"",type:"uint8"}],type:"function"},{constant:!0,inputs:[],name:"totalSupply",outputs:[{name:"",type:"uint256"}],type:"function"},{constant:!0,inputs:[{name:"_owner",type:"address"}],name:"balanceOf",outputs:[{name:"balance",type:"uint256"}],type:"function"},{constant:!0,inputs:[{name:"_owner",type:"address"},{name:"_spender",type:"address"}],name:"allowance",outputs:[{name:"",type:"uint256"}],type:"function"},{constant:!1,inputs:[{name:"_to",type:"address"},{name:"_value",type:"uint256"}],name:"transfer",outputs:[{name:"",type:"bool"}],type:"function"},{constant:!1,inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_value",type:"uint256"}],name:"transferFrom",outputs:[{name:"",type:"bool"}],type:"function"},{constant:!1,inputs:[{name:"_spender",type:"address"},{name:"_value",type:"uint256"}],name:"approve",outputs:[{name:"",type:"bool"}],type:"function"},{anonymous:!1,inputs:[{indexed:!0,name:"from",type:"address"},{indexed:!0,name:"to",type:"address"},{indexed:!1,name:"value",type:"uint256"}],name:"Transfer",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"owner",type:"address"},{indexed:!0,name:"spender",type:"address"},{indexed:!1,name:"value",type:"uint256"}],name:"Approval",type:"event"}];class A extends Error{code;originalError;constructor(a,b,c){super(a),this.name="SwapError",this.code=b,this.originalError=c}}let B=null;function C(){return B||(B=new w.JsonRpcProvider(u.env.NEXT_PUBLIC_RPC_URL)),B}function D(a){if(!a||!(0,y.isAddress)(a))throw new A(`Invalid Ethereum address: ${a}`,"INVALID_PAIR")}async function E(a,b=3,c=1e3){let d=null;for(let e=0;e<b;e++)try{return await a()}catch(a){if(d=a,a instanceof A&&"INVALID_PAIR"===a.code)throw a;if(e===b-1)break;await new Promise(a=>setTimeout(a,c*Math.pow(2,e)))}throw new A(`Network operation failed after ${b} retries: ${d?.message}`,"NETWORK_ERROR",d)}async function F(a,b,c,d=.5){let e=u.env.NEXT_PUBLIC_NETWORK,f=(0,k.getTokenAddress)(a,e),g=(0,k.getTokenAddress)(b,e);if(!f||!g)throw new A("Token not supported on current network","INVALID_PAIR");if(f===g)throw new A("Cannot swap same token","INVALID_PAIR");let h=k.TOKENS[a],i=k.TOKENS[b],j=(0,x.parseUnits)(c,h.decimals);return E(async()=>{try{let e=C(),h=new v.Contract("0x61fFE014bA17989E743c5F6cB21bF9697530B21e",p,e),[k,l,m,n]=await h.quoteExactInputSingle.staticCall({tokenIn:f,tokenOut:g,amountIn:j,fee:500,sqrtPriceLimitX96:0}),o=(0,x.formatUnits)(k,i.decimals),q=(parseFloat(o)/parseFloat(c)).toFixed(6),r=parseFloat(q),s=100*Math.abs((r-1)/1);if(s>15)throw new A(`Price impact too high: ${s.toFixed(2)}%`,"EXCESSIVE_PRICE_IMPACT");let t=k*BigInt(Math.floor(1e4*(1-d/100)))/BigInt(1e4),u=(0,x.formatUnits)(t,i.decimals);return{tokenIn:a,tokenOut:b,amountIn:c,amountOut:o,amountInRaw:j.toString(),amountOutRaw:k.toString(),exchangeRate:q,priceImpact:s,minAmountOut:t.toString(),minAmountOutFormatted:u,slippageTolerance:d,poolFee:500,estimatedGas:n.toString(),timestamp:Date.now()}}catch(a){if(a instanceof A)throw a;if(a instanceof Error&&a.message.includes("STF"))throw new A("Insufficient liquidity for this swap amount","INSUFFICIENT_LIQUIDITY",a);throw new A(`Failed to get swap quote: ${a instanceof Error?a.message:"Unknown error"}`,"NETWORK_ERROR",a)}})}async function G(a,b,c){return D(a),D(b),E(async()=>{try{let d=C(),e=new v.Contract(a,z,d),f=await e.allowance(b,o),g=f.toString(),h=f>=BigInt(c);return{tokenAddress:a,spenderAddress:o,allowance:g,isSufficient:h,requiredAmount:c}}catch(a){throw new A(`Failed to check allowance: ${a instanceof Error?a.message:"Unknown error"}`,"NETWORK_ERROR",a)}})}async function H(a,b,c){return D(b),E(async()=>{try{let d=C(),e=new v.Contract(b,z,d).connect(a),f=await e.approve(o,c),g=await f.wait();if(!g||0===g.status)throw new A("Token approval transaction failed","APPROVAL_FAILED");return f.hash}catch(a){if(a instanceof A)throw a;throw new A(`Token approval failed: ${a instanceof Error?a.message:"Unknown error"}`,"APPROVAL_FAILED",a)}})}async function I(a,b,c){return E(async()=>{try{let a,d=C(),e=await d.getFeeData(),f=e.maxFeePerGas||(0,x.parseUnits)("50","gwei"),g=e.maxPriorityFeePerGas||(0,x.parseUnits)("2","gwei"),h=BigInt(b.estimatedGas)*BigInt(120)/BigInt(100);c&&(a=BigInt(5e4));let i=(h+(a||BigInt(0)))*f,j=(0,x.formatUnits)(i,"ether");return{approvalGasLimit:a,swapGasLimit:h,maxFeePerGas:f,maxPriorityFeePerGas:g,totalCostEth:j,totalCostWei:i}}catch(a){throw new A(`Failed to estimate gas: ${a instanceof Error?a.message:"Unknown error"}`,"NETWORK_ERROR",a)}})}async function J(a,b){let c=u.env.NEXT_PUBLIC_NETWORK,d=(0,k.getTokenAddress)(b.tokenIn,c),e=(0,k.getTokenAddress)(b.tokenOut,c);if(!d||!e)throw new A("Token not supported on current network","INVALID_PAIR");return E(async()=>{try{let c=C(),f=new v.Contract(d,z,c);if(await f.balanceOf(a.address)<BigInt(b.amountInRaw))throw new A("Insufficient token balance for swap","INSUFFICIENT_BALANCE");let g=await c.getBalance(a.address),h=await I(a,b,!1);if(g<h.totalCostWei)throw new A(`Insufficient ETH for gas. Required: ${h.totalCostEth} ETH`,"INSUFFICIENT_BALANCE");let i=Math.floor(Date.now()/1e3)+1200,j={tokenIn:d,tokenOut:e,fee:b.poolFee,recipient:a.address,deadline:i,amountIn:b.amountInRaw,amountOutMinimum:b.minAmountOut,sqrtPriceLimitX96:0},k=new v.Contract(o,q,c).connect(a),l=await k.exactInputSingle(j,{maxFeePerGas:h.maxFeePerGas,maxPriorityFeePerGas:h.maxPriorityFeePerGas,gasLimit:h.swapGasLimit}),m=await l.wait();if(!m||0===m.status)throw new A("Swap transaction failed","SWAP_FAILED");return l.hash}catch(a){if(a instanceof A)throw a;if(a instanceof Error&&a.message.includes("Too little received"))throw new A("Slippage tolerance exceeded. Try increasing slippage or reducing amount.","SLIPPAGE_EXCEEDED",a);throw new A(`Swap execution failed: ${a instanceof Error?a.message:"Unknown error"}`,"SWAP_FAILED",a)}})}function K(a){return({INSUFFICIENT_BALANCE:"Insufficient balance to complete this swap.",INSUFFICIENT_LIQUIDITY:"Not enough liquidity available for this swap amount.",EXCESSIVE_PRICE_IMPACT:"Price impact is too high. Try reducing the swap amount.",SLIPPAGE_EXCEEDED:"Price changed too much. Try increasing slippage tolerance.",APPROVAL_FAILED:"Failed to approve token spending. Please try again.",SWAP_FAILED:"Swap transaction failed. Please try again.",QUOTE_EXPIRED:"Price quote expired. Fetching new quote...",INVALID_PAIR:"Invalid token pair selected.",NETWORK_ERROR:"Network error. Please check your connection and try again.",UNKNOWN_ERROR:"An unexpected error occurred. Please try again."})[a.code]||a.message}var L=a.i(77423);let M=[.1,.5,1];function N(){let{address:a,isUnlocked:c}=(0,e.useWallet)(),{data:j}=(0,L.useBalance)(),[m,n]=(0,d.useState)("USDC"),[o,p]=(0,d.useState)("USDT"),[q,v]=(0,d.useState)(""),[w,x]=(0,d.useState)(.5),[y,z]=(0,d.useState)(""),[B,C]=(0,d.useState)(!1),{quote:D,gasEstimate:E,allowance:N,status:O,error:P,isLoadingQuote:Q,isApproving:R,isSwapping:S,txHash:T,fetchQuote:U,approve:V,swap:W,clearError:X,reset:Y,needsApproval:Z}=function(a,b={}){let{refreshInterval:c=3e4,autoRefresh:e=!0}=b,[f,g]=(0,d.useState)(null),[h,i]=(0,d.useState)(null),[j,l]=(0,d.useState)(null),[m,n]=(0,d.useState)("idle"),[o,p]=(0,d.useState)(null),[q,r]=(0,d.useState)(null),v=(0,d.useRef)(null),w=(0,d.useRef)(null),x=(0,d.useCallback)(()=>{v.current&&(clearTimeout(v.current),v.current=null)},[]),y=(0,d.useCallback)(async(b,d,f,h)=>{if(!a)return void p("Wallet not connected");if(!f||0>=parseFloat(f))return void p("Invalid amount");x(),n("fetching-quote"),p(null);try{let j=await F(b,d,f,h);g(j);let m=u.env.NEXT_PUBLIC_NETWORK,o=(0,k.getTokenAddress)(b,m);if(o){let b=await G(o,a,j.amountInRaw);l(b),i(null)}w.current={tokenIn:b,tokenOut:d,amountIn:f,slippage:h},e&&(v.current=setTimeout(()=>{if(w.current){let a=w.current;y(a.tokenIn,a.tokenOut,a.amountIn,a.slippage)}},c)),n("idle")}catch(a){console.error("Failed to fetch quote:",a),a instanceof A?p(K(a)):p("Failed to fetch quote. Please try again."),n("error"),g(null),l(null),i(null)}},[a,e,c,x]),z=(0,d.useCallback)(async b=>{if(!f||!j||!a)return void p("Missing required data for approval");if(j.isSufficient)return void p("Approval not needed");n("approving"),p(null);try{let c=await (0,t.unlockWallet)(b),d=new s.Wallet(c.privateKey),e=await H(d,j.tokenAddress,j.requiredAmount);console.log("Approval transaction:",e);let f=await G(j.tokenAddress,a,j.requiredAmount);l(f),n("idle")}catch(a){console.error("Approval failed:",a),a instanceof A?p(K(a)):p("Token approval failed. Please try again."),n("error")}},[f,j,a]),B=(0,d.useCallback)(async b=>{if(!f||!j||!a)return void p("Missing required data for swap");if(!j.isSufficient)return void p("Token approval required before swap");if(!function(a,b=3e4){return Date.now()-a.timestamp<b}(f)){p("Quote expired. Please refresh."),n("error");return}x(),n("swapping"),p(null);try{let a=await (0,t.unlockWallet)(b),c=new s.Wallet(a.privateKey),d=await I(c,f,!1);i(d);let e=await J(c,f);r(e),console.log("Swap transaction:",e),n("success")}catch(a){console.error("Swap failed:",a),a instanceof A?p(K(a)):p("Swap failed. Please try again."),n("error")}},[f,j,a,x]),C=(0,d.useCallback)(()=>{p(null),"error"===m&&n("idle")},[m]),D=(0,d.useCallback)(()=>{x(),g(null),i(null),l(null),n("idle"),p(null),r(null),w.current=null},[x]);(0,d.useEffect)(()=>()=>{x()},[x]);let E="fetching-quote"===m,L="approving"===m,M="swapping"===m,N=!!j&&!j.isSufficient;return{quote:f,gasEstimate:h,allowance:j,status:m,error:o,isLoadingQuote:E,isApproving:L,isSwapping:M,txHash:q,fetchQuote:y,approve:z,swap:B,clearError:C,reset:D,needsApproval:N}}(a),$=j?.find(a=>a.symbol===m);(0,d.useEffect)(()=>{if(q&&parseFloat(q)>0&&m&&o){let a=setTimeout(()=>{U(m,o,q,w)},500);return()=>clearTimeout(a)}Y()},[m,o,q,w,U,Y]),(0,d.useEffect)(()=>{"success"===O&&(v(""),Y())},[O,Y]);let _=async a=>{await W(a)},aa=async a=>{await V(a)},ab=c&&q&&parseFloat(q)>0&&D&&!Q&&!Z,ac=c&&D&&Z,ad=!!($&&q&&parseFloat(q)>parseFloat($.balanceFormatted));return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(f.Card,{className:"max-w-lg mx-auto",children:(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Swap Tokens"}),(0,b.jsx)("button",{type:"button",className:"p-2 rounded-lg hover:bg-white/5 transition-colors",title:"Slippage Settings",children:(0,b.jsxs)("svg",{className:"w-5 h-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-400",children:"Slippage Tolerance"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[M.map(a=>(0,b.jsxs)("button",{type:"button",onClick:()=>{x(a),z("")},className:`
                    px-4 py-2 rounded-lg font-medium transition-colors
                    ${w===a&&!y?"bg-blue-500 text-white":"bg-white/5 text-gray-300 hover:bg-white/10"}
                  `,children:[a,"%"]},a)),(0,b.jsx)(h.Input,{type:"number",value:y,onChange:a=>(a=>{z(a);let b=parseFloat(a);!isNaN(b)&&b>0&&b<=50&&x(b)})(a.target.value),placeholder:"Custom",className:"w-24",min:"0",max:"50",step:"0.1"})]})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-400",children:"From"}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(l,{selectedToken:m,onSelect:n,excludeToken:o}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(h.Input,{type:"number",value:q,onChange:a=>v(a.target.value),placeholder:"0.0",className:"text-2xl pr-20",min:"0",step:"any"}),(0,b.jsx)("button",{type:"button",onClick:()=>{$&&v($.balanceFormatted)},className:"absolute right-3 top-1/2 -translate-y-1/2 px-3 py-1 rounded-lg bg-blue-500/20 text-blue-400 text-sm font-medium hover:bg-blue-500/30 transition-colors",children:"MAX"})]}),$&&(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-gray-400",children:"Balance:"}),(0,b.jsxs)("span",{className:"text-white font-medium",children:[parseFloat($.balanceFormatted).toFixed(4)," ",m]})]})]})]}),(0,b.jsx)("div",{className:"flex justify-center -my-2",children:(0,b.jsx)("button",{type:"button",onClick:()=>{n(o),p(m)},className:"p-3 rounded-full bg-gray-800 border-4 border-gray-900 hover:bg-gray-700 transition-colors z-10",children:(0,b.jsx)("svg",{className:"w-5 h-5 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"})})})}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-400",children:"To"}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(l,{selectedToken:o,onSelect:p,excludeToken:m}),(0,b.jsx)("div",{className:"p-4 rounded-xl bg-white/5 border border-white/10",children:Q?(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-5 h-5 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),(0,b.jsx)("span",{className:"text-gray-400",children:"Fetching quote..."})]}):D?(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-2xl font-bold text-white",children:parseFloat(D.amountOut).toFixed(6)}),(0,b.jsxs)("p",{className:"text-xs text-gray-400 mt-1",children:["Min received: ",parseFloat(D.minAmountOutFormatted).toFixed(6)]})]}):(0,b.jsx)("p",{className:"text-gray-400",children:"Enter amount to see quote"})})]})]}),D&&!Q&&(0,b.jsxs)("div",{className:"space-y-2 p-4 rounded-xl bg-white/5 border border-white/10",children:[(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-gray-400",children:"Rate"}),(0,b.jsxs)("span",{className:"text-white",children:["1 ",m," = ",D.exchangeRate," ",o]})]}),(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-gray-400",children:"Price Impact"}),(0,b.jsxs)("span",{className:D.priceImpact>5?"text-yellow-400":"text-green-400",children:[D.priceImpact.toFixed(2),"%"]})]}),(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-gray-400",children:"Pool Fee"}),(0,b.jsxs)("span",{className:"text-white",children:[(D.poolFee/1e4).toFixed(2),"%"]})]}),E&&(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-gray-400",children:"Network Fee"}),(0,b.jsxs)("span",{className:"text-white",children:["~",parseFloat(E.totalCostEth).toFixed(6)," ETH"]})]})]}),ad&&(0,b.jsxs)(i.Alert,{variant:"error",children:["Insufficient ",m," balance"]}),P&&(0,b.jsx)(i.Alert,{variant:"error",children:(0,b.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,b.jsx)("span",{children:P}),(0,b.jsx)("button",{type:"button",onClick:X,className:"text-red-400 hover:text-red-300",children:(0,b.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),"success"===O&&T&&(0,b.jsx)(i.Alert,{variant:"success",children:(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("p",{className:"font-semibold",children:"Swap Successful!"}),(0,b.jsx)("a",{href:`https://etherscan.io/tx/${T}`,target:"_blank",rel:"noopener noreferrer",className:"text-sm underline hover:no-underline",children:"View on Etherscan"})]})}),c?ac?(0,b.jsxs)(g.Button,{variant:"primary",onClick:()=>C(!0),disabled:ad,className:"w-full",children:["Approve ",m]}):(0,b.jsx)(g.Button,{variant:"primary",onClick:()=>C(!0),disabled:!ab||ad,isLoading:Q,className:"w-full",children:Q?"Loading...":ab?"Review Swap":"Enter Amount"}):(0,b.jsx)(g.Button,{variant:"secondary",disabled:!0,className:"w-full",children:"Unlock Wallet to Swap"})]})}),D&&(0,b.jsx)(r,{isOpen:B,onClose:()=>C(!1),quote:D,gasEstimate:E,needsApproval:Z,onConfirm:_,onApprove:aa,isSwapping:S,isApproving:R})]})}function O(){let a=(0,c.useRouter)(),{isUnlocked:f,hasExistingWallet:g}=(0,e.useWallet)();return(0,d.useEffect)(()=>{g()||a.push("/onboarding")},[g,a]),(0,d.useEffect)(()=>{g()&&!f&&a.push("/unlock")},[g,f,a]),(0,b.jsx)("div",{className:"min-h-screen p-4 sm:p-6 lg:p-8",children:(0,b.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,b.jsxs)("div",{className:"mb-8",children:[(0,b.jsx)("h1",{className:"text-3xl sm:text-4xl font-bold text-white mb-2",children:"Token Swap"}),(0,b.jsx)("p",{className:"text-gray-400",children:"Swap stablecoins instantly using Uniswap V3"})]}),(0,b.jsx)("div",{className:"mb-6 p-4 rounded-xl bg-blue-500/10 border border-blue-500/20",children:(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("svg",{className:"w-5 h-5 text-blue-400 mt-0.5 shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("p",{className:"text-sm text-blue-400 font-semibold",children:"About Token Swaps"}),(0,b.jsx)("p",{className:"text-sm text-gray-300",children:"Swaps are executed on Uniswap V3 with on-chain prices. You'll need to approve the token before your first swap. Network fees apply for each transaction."})]})]})}),(0,b.jsx)(N,{}),(0,b.jsxs)("div",{className:"mt-8 p-6 rounded-xl bg-white/5 border border-white/10",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"How it works"}),(0,b.jsxs)("div",{className:"space-y-3 text-sm text-gray-300",children:[(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:"w-6 h-6 rounded-full bg-blue-500/20 flex items-center justify-center shrink-0 mt-0.5",children:(0,b.jsx)("span",{className:"text-blue-400 font-semibold text-xs",children:"1"})}),(0,b.jsxs)("p",{children:[(0,b.jsx)("strong",{className:"text-white",children:"Select tokens:"})," Choose the token you want to swap from and the token you want to receive."]})]}),(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:"w-6 h-6 rounded-full bg-blue-500/20 flex items-center justify-center shrink-0 mt-0.5",children:(0,b.jsx)("span",{className:"text-blue-400 font-semibold text-xs",children:"2"})}),(0,b.jsxs)("p",{children:[(0,b.jsx)("strong",{className:"text-white",children:"Enter amount:"})," Type the amount you want to swap. The output amount will be calculated automatically."]})]}),(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:"w-6 h-6 rounded-full bg-blue-500/20 flex items-center justify-center shrink-0 mt-0.5",children:(0,b.jsx)("span",{className:"text-blue-400 font-semibold text-xs",children:"3"})}),(0,b.jsxs)("p",{children:[(0,b.jsx)("strong",{className:"text-white",children:"Review details:"})," Check the exchange rate, price impact, and fees before confirming."]})]}),(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:"w-6 h-6 rounded-full bg-blue-500/20 flex items-center justify-center shrink-0 mt-0.5",children:(0,b.jsx)("span",{className:"text-blue-400 font-semibold text-xs",children:"4"})}),(0,b.jsxs)("p",{children:[(0,b.jsx)("strong",{className:"text-white",children:"Approve & Swap:"})," First-time swaps require token approval. Then confirm the swap with your password."]})]})]}),(0,b.jsxs)("div",{className:"mt-6 pt-6 border-t border-white/10",children:[(0,b.jsx)("h4",{className:"text-sm font-semibold text-white mb-2",children:"Important Notes"}),(0,b.jsxs)("ul",{className:"space-y-2 text-sm text-gray-400",children:[(0,b.jsxs)("li",{className:"flex items-start gap-2",children:[(0,b.jsx)("span",{className:"text-blue-400 mt-1",children:"•"}),(0,b.jsx)("span",{children:"Slippage tolerance protects you from price changes during the swap"})]}),(0,b.jsxs)("li",{className:"flex items-start gap-2",children:[(0,b.jsx)("span",{className:"text-blue-400 mt-1",children:"•"}),(0,b.jsx)("span",{children:"Price impact shows how much your trade affects the market price"})]}),(0,b.jsxs)("li",{className:"flex items-start gap-2",children:[(0,b.jsx)("span",{className:"text-blue-400 mt-1",children:"•"}),(0,b.jsx)("span",{children:"Network fees (gas) are paid in ETH and vary based on network congestion"})]}),(0,b.jsxs)("li",{className:"flex items-start gap-2",children:[(0,b.jsx)("span",{className:"text-blue-400 mt-1",children:"•"}),(0,b.jsx)("span",{children:"Quotes refresh automatically every 30 seconds"})]})]})]})]})]})})}}];

//# sourceMappingURL=src_app_swap_page_tsx_f849337a._.js.map