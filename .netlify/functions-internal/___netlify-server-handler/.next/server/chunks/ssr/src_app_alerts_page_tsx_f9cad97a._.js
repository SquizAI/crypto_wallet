module.exports=[38153,a=>{"use strict";a.s(["default",()=>u],38153);var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(50832),f=a.i(20735),g=a.i(9008);function h(a){}function i(a,b){let c=[],d=c.findIndex(b=>b.id===a);if(-1===d)throw Error("Alert not found");let e={...c[d],...b};return c[d]=e,h(c),e}async function j(){let a=[].filter(a=>"active"===a.status);if(0===a.length)return[];try{let b=await (0,g.getTokenPrices)(),c=[];for(let d of a){let a=b[d.token];if(a&&function(a,b){switch(a.condition){case"above":return b>a.targetValue;case"below":return b<a.targetValue;case"percent_up":if(!a.basePrice)return!1;return(b-a.basePrice)/a.basePrice*100>=a.targetValue;case"percent_down":if(!a.basePrice)return!1;return(a.basePrice-b)/a.basePrice*100>=a.targetValue;default:return!1}}(d,a.usd)){let a=i(d.id,{status:"triggered",triggeredAt:new Date().toISOString(),triggerCount:d.triggerCount+1});c.push(a)}}return c}catch(a){return console.error("Failed to check alerts:",a),[]}}function k(a){let{condition:b,targetValue:c,token:d}=a;switch(b){case"above":return`${d} price goes above $${c.toFixed(4)}`;case"below":return`${d} price falls below $${c.toFixed(4)}`;case"percent_up":return`${d} price increases by ${c.toFixed(2)}%`;case"percent_down":return`${d} price decreases by ${c.toFixed(2)}%`;default:return"Unknown condition"}}var l=a.i(96438),m=a.i(94988);let n=["USDC","USDT","DAI"],o=[{value:"above",label:"Price goes above"},{value:"below",label:"Price falls below"},{value:"percent_up",label:"Price increases by %"},{value:"percent_down",label:"Price decreases by %"}];function p({alert:a,onSubmit:d,onCancel:e,currentPrices:f}){let[g,h]=(0,c.useState)(a?.token||"USDC"),[i,j]=(0,c.useState)(a?.condition||"above"),[k,p]=(0,c.useState)(a?.targetValue.toString()||""),[q,r]=(0,c.useState)(a?.label||""),[s,t]=(0,c.useState)(!1),[u,v]=(0,c.useState)(null);(0,c.useEffect)(()=>{a&&(h(a.token),j(a.condition),p(a.targetValue.toString()),r(a.label||""))},[a]);let w=async a=>{if(a.preventDefault(),(()=>{if(v(null),!k||""===k.trim())return v("Please enter a target value"),!1;let a=parseFloat(k);return isNaN(a)||a<=0?(v("Target value must be a positive number"),!1):("percent_up"===i||"percent_down"===i)&&a>100?(v("Percentage cannot exceed 100%"),!1):"above"!==i&&"below"!==i||!(a>10)||(v("Price alert seems too high for stablecoins (max $10)"),!1)})()){t(!0),v(null);try{let a=parseFloat(k);await d(g,i,a,q||void 0)}catch(a){v(a instanceof Error?a.message:"Failed to save alert")}finally{t(!1)}}},x=f?.[g],y="percent_up"===i||"percent_down"===i;return(0,b.jsxs)("form",{onSubmit:w,className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"token",className:"block text-sm font-medium text-gray-300 mb-2",children:"Token"}),(0,b.jsx)("select",{id:"token",value:g,onChange:a=>h(a.target.value),className:"w-full px-4 py-3 rounded-xl glass text-white border border-white/10 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",disabled:s,children:n.map(a=>(0,b.jsxs)("option",{value:a,className:"bg-slate-800",children:[a,f?.[a]&&` ($${f[a].toFixed(4)})`]},a))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"condition",className:"block text-sm font-medium text-gray-300 mb-2",children:"Alert Condition"}),(0,b.jsx)("select",{id:"condition",value:i,onChange:a=>j(a.target.value),className:"w-full px-4 py-3 rounded-xl glass text-white border border-white/10 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",disabled:s,children:o.map(a=>(0,b.jsx)("option",{value:a.value,className:"bg-slate-800",children:a.label},a.value))})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{htmlFor:"targetValue",className:"block text-sm font-medium text-gray-300 mb-2",children:["Target ",y?"Percentage":"Price"]}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(m.Input,{id:"targetValue",type:"number",step:y?"0.01":"0.0001",value:k,onChange:a=>p(a.target.value),placeholder:y?"5.0":"1.0000",disabled:s}),(0,b.jsx)("span",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-400",children:y?"%":"$"})]}),x&&(0,b.jsxs)("p",{className:"mt-2 text-xs text-gray-400",children:["Current ",g," price: $",x.toFixed(4)]})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{htmlFor:"label",className:"block text-sm font-medium text-gray-300 mb-2",children:["Label ",(0,b.jsx)("span",{className:"text-gray-500",children:"(Optional)"})]}),(0,b.jsx)(m.Input,{id:"label",type:"text",value:q,onChange:a=>r(a.target.value),placeholder:"e.g., USDC dip opportunity",disabled:s,maxLength:50}),(0,b.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"Give your alert a memorable name"})]}),u&&(0,b.jsx)("div",{className:"p-4 rounded-xl bg-red-500/10 border border-red-500/30",children:(0,b.jsx)("p",{className:"text-sm text-red-400",children:u})}),(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsx)(l.Button,{type:"submit",variant:"primary",fullWidth:!0,loading:s,disabled:s,children:a?"Update Alert":"Create Alert"}),(0,b.jsx)(l.Button,{type:"button",variant:"secondary",fullWidth:!0,onClick:e,disabled:s,children:"Cancel"})]})]})}var q=a.i(48313),r=a.i(55486);function s({token:a,price:c}){return(0,b.jsx)("div",{className:"glass border border-white/10 rounded-xl p-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-lg font-bold text-white mb-1",children:a}),(0,b.jsxs)("p",{className:"text-2xl font-bold text-blue-400",children:["$",c.toFixed(4)]})]}),(0,b.jsx)("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-blue-500 to-cyan-500 flex items-center justify-center",children:(0,b.jsx)("span",{className:"text-2xl",children:"$"})})]})})}function t({alert:a,currentPrice:c,onToggle:d,onReset:e,onDelete:f}){return(0,b.jsxs)("div",{className:"glass border border-white/10 rounded-xl p-5 transition-all duration-200 hover:border-white/20",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)("h3",{className:"text-lg font-bold text-white",children:a.token}),(0,b.jsx)(r.Badge,{className:{active:"bg-green-500/20 text-green-400 border-green-500/30",triggered:"bg-amber-500/20 text-amber-400 border-amber-500/30",disabled:"bg-gray-500/20 text-gray-400 border-gray-500/30"}[a.status],children:a.status})]}),a.label&&(0,b.jsx)("p",{className:"text-sm text-gray-400 mb-2",children:a.label}),(0,b.jsx)("p",{className:"text-sm text-gray-300",children:k(a)}),c&&(0,b.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Current price: $",c.toFixed(4)]})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("button",{onClick:d,className:"p-2 rounded-lg glass hover:bg-white/10 transition-colors","aria-label":"active"===a.status?"Disable alert":"Enable alert",children:"active"===a.status?(0,b.jsx)("svg",{className:"w-5 h-5 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}):(0,b.jsx)("svg",{className:"w-5 h-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"})})}),"triggered"===a.status&&(0,b.jsx)("button",{onClick:e,className:"p-2 rounded-lg glass hover:bg-white/10 transition-colors","aria-label":"Reset alert",children:(0,b.jsx)("svg",{className:"w-5 h-5 text-blue-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),(0,b.jsx)("button",{onClick:f,className:"p-2 rounded-lg glass hover:bg-red-500/20 transition-colors","aria-label":"Delete alert",children:(0,b.jsx)("svg",{className:"w-5 h-5 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-500 pt-3 border-t border-white/10",children:[(0,b.jsxs)("span",{children:["Created ",new Date(a.createdAt).toLocaleDateString()]}),a.triggerCount>0&&(0,b.jsxs)("span",{children:["Triggered ",a.triggerCount,"x"]})]})]})}function u(){let a=(0,d.useRouter)(),{isUnlocked:m}=(0,e.useWallet)(),{alerts:n,prices:o,isLoading:r,error:u,stats:v,createNewAlert:w,deleteExistingAlert:x,toggleAlert:y,resetTriggeredAlert:z,refreshPrices:A,lastUpdate:B}=function(){let{addNotification:a}=(0,f.useNotifications)(),[b,d]=(0,c.useState)([]),[e,l]=(0,c.useState)(null),[m,n]=(0,c.useState)(!0),[o,p]=(0,c.useState)(null),[q,r]=(0,c.useState)(null),s=(0,c.useRef)(null),t=(0,c.useCallback)(()=>{try{d([])}catch(a){console.error("Failed to load alerts:",a),p("Failed to load alerts")}},[]),u=(0,c.useCallback)(async(a=!1)=>{try{let b=await (0,g.getTokenPrices)(a);l(b),r(new Date),p(null)}catch(a){console.error("Failed to fetch prices:",a),p(a instanceof Error?a.message:"Failed to fetch prices")}},[]),v=(0,c.useCallback)(async()=>{try{for(let b of(await j())){let c=e?.[b.token];c&&a("price_alert",`Price Alert: ${b.token}`,`${k(b)} - Current price: $${c.usd.toFixed(4)}`,"high",{alertId:b.id,token:b.token,currentPrice:c.usd,targetPrice:b.targetValue})}t()}catch(a){console.error("Failed to check alerts:",a)}},[e,a,t]);(0,c.useEffect)(()=>{(async()=>{n(!0),t(),await u(),n(!1)})()},[t,u]),(0,c.useEffect)(()=>(s.current&&clearInterval(s.current),b.filter(a=>"active"===a.status).length>0&&(s.current=setInterval(async()=>{await u(!0),await v()},6e4)),()=>{s.current&&clearInterval(s.current)}),[b,u,v]);let w=(0,c.useCallback)(async(b,c,d,e)=>{try{let f;("percent_up"===c||"percent_down"===c)&&(f=(await (0,g.getTokenPrice)(b)).usd);let i=function(a,b,c,d,e){let f={id:`alert_${Date.now()}_${Math.random().toString(36).substring(2,9)}`,token:a,condition:b,targetValue:c,status:"active",createdAt:new Date().toISOString(),triggeredAt:null,triggerCount:0,label:d,basePrice:e},g=[];return g.push(f),h(g),f}(b,c,d,e,f);return t(),a("system","Alert Created",`New price alert for ${b}: ${k(i)}`,"low"),i}catch(a){throw p(a instanceof Error?a.message:"Failed to create alert"),a}},[t,a]),x=(0,c.useCallback)((a,b)=>{try{i(a,b),t()}catch(a){throw p(a instanceof Error?a.message:"Failed to update alert"),a}},[t]),y=(0,c.useCallback)(b=>{try{let c=[],d=c.filter(a=>a.id!==b);if(d.length===c.length)throw Error("Alert not found");h(d),t(),a("system","Alert Deleted","Price alert has been removed","low")}catch(a){throw p(a instanceof Error?a.message:"Failed to delete alert"),a}},[t,a]),z=(0,c.useCallback)(b=>{try{let c=function(a){let b=[].find(b=>b.id===a);if(!b)throw Error("Alert not found");return i(a,{status:"active"===b.status?"disabled":"active"})}(b);t();let d="active"===c.status?"enabled":"disabled";a("system",`Alert ${d}`,`Price alert has been ${d}`,"low")}catch(a){p(a instanceof Error?a.message:"Failed to toggle alert")}},[t,a]),A=(0,c.useCallback)(b=>{try{i(b,{status:"active"}),t(),a("system","Alert Reset","Alert has been reactivated","low")}catch(a){p(a instanceof Error?a.message:"Failed to reset alert")}},[t,a]),B=(0,c.useCallback)(async()=>{await u(!0),await v()},[u,v]);return{alerts:b,prices:e,isLoading:m,error:o,stats:function(){let a=[];return{total:a.length,active:a.filter(a=>"active"===a.status).length,triggered:a.filter(a=>"triggered"===a.status).length,disabled:a.filter(a=>"disabled"===a.status).length}}(),createNewAlert:w,updateExistingAlert:x,deleteExistingAlert:y,toggleAlert:z,resetTriggeredAlert:A,refreshPrices:B,lastUpdate:q}}(),[C,D]=(0,c.useState)(!1),[E,F]=(0,c.useState)(!1);if(!m)return a.push("/unlock"),null;let G=async(a,b,c,d)=>{await w(a,b,c,d),D(!1)},H=async()=>{F(!0),await A(),F(!1)},I=o?{USDC:o.USDC.usd,USDT:o.USDT.usd,DAI:o.DAI.usd}:void 0;return(0,b.jsxs)("div",{className:"min-h-screen p-4 sm:p-6 lg:p-8",children:[(0,b.jsxs)("div",{className:"max-w-6xl mx-auto space-y-6",children:[(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl sm:text-4xl font-bold text-white mb-2",children:"Price Alerts"}),(0,b.jsx)("p",{className:"text-gray-400",children:"Set custom price alerts for your stablecoins"})]}),(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsxs)(l.Button,{variant:"secondary",onClick:H,loading:E,disabled:E,children:[(0,b.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh"]}),(0,b.jsxs)(l.Button,{variant:"primary",onClick:()=>D(!0),children:[(0,b.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"New Alert"]})]})]}),u&&(0,b.jsx)("div",{className:"p-4 rounded-xl bg-red-500/10 border border-red-500/30",children:(0,b.jsx)("p",{className:"text-sm text-red-400",children:u})}),r?(0,b.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-500 border-t-transparent"})}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:o&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(s,{token:"USDC",price:o.USDC.usd}),(0,b.jsx)(s,{token:"USDT",price:o.USDT.usd}),(0,b.jsx)(s,{token:"DAI",price:o.DAI.usd})]})}),B&&(0,b.jsxs)("p",{className:"text-xs text-gray-500 text-center",children:["Last updated: ",B.toLocaleTimeString()]}),(0,b.jsxs)("div",{className:"glass border border-white/10 rounded-xl p-6",children:[(0,b.jsx)("h2",{className:"text-xl font-bold text-white mb-4",children:"Alert Statistics"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:[(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("p",{className:"text-3xl font-bold text-blue-400",children:v.total}),(0,b.jsx)("p",{className:"text-sm text-gray-400 mt-1",children:"Total"})]}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("p",{className:"text-3xl font-bold text-green-400",children:v.active}),(0,b.jsx)("p",{className:"text-sm text-gray-400 mt-1",children:"Active"})]}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("p",{className:"text-3xl font-bold text-amber-400",children:v.triggered}),(0,b.jsx)("p",{className:"text-sm text-gray-400 mt-1",children:"Triggered"})]}),(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("p",{className:"text-3xl font-bold text-gray-400",children:v.disabled}),(0,b.jsx)("p",{className:"text-sm text-gray-400 mt-1",children:"Disabled"})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-2xl font-bold text-white mb-4",children:"Your Alerts"}),0===n.length?(0,b.jsxs)("div",{className:"glass border border-white/10 rounded-xl p-12 text-center",children:[(0,b.jsx)("svg",{className:"w-16 h-16 mx-auto text-gray-600 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),(0,b.jsx)("h3",{className:"text-xl font-bold text-white mb-2",children:"No alerts yet"}),(0,b.jsx)("p",{className:"text-gray-400 mb-6",children:"Create your first price alert to get notified of market movements"}),(0,b.jsx)(l.Button,{variant:"primary",onClick:()=>D(!0),children:"Create First Alert"})]}):(0,b.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:n.map(a=>(0,b.jsx)(t,{alert:a,currentPrice:o?.[a.token]?.usd,onToggle:()=>y(a.id),onReset:()=>z(a.id),onDelete:()=>x(a.id)},a.id))})]})]})]}),(0,b.jsx)(q.Modal,{isOpen:C,onClose:()=>D(!1),title:"Create Price Alert",children:(0,b.jsx)(p,{onSubmit:G,onCancel:()=>D(!1),currentPrices:I})})]})}}];

//# sourceMappingURL=src_app_alerts_page_tsx_f9cad97a._.js.map